!function(t,e){"use strict";function i(e,i){var n=t('<li data-value="'+e+'" class="dropdown-option">'+i+"</li>");this.element.find(".dropdown-options > ul").append(n),this.options.unbind("click"),this.options=this.element.find(".dropdown-option"),this.options.click(this.select.bind(this))}function n(t,e){var i=jQuery.Event("b40.dropdown."+t);i.dropdown=e,e.element.trigger(i)}function s(t){return void 0===t?void 0:t+""}function o(i){i&&3===i.which||t.each(e.Dropdown.all(),function(t,n){n.active&&(i&&"click"===i.type&&e.contains(n.get(),i.target)||i.isDefaultPrevented()||n.hide())})}function a(){this.options.removeClass("active"),this.element.find(".dropdown-label-text").text(this.originalLabel),this.setByOption(this.options.get(0)),n("change",this)}function r(){return this.element}function l(){return this.selectedValue}function h(t){t&&t.preventDefault(),this.active=!1,this.element.removeClass("active"),n("hide",this)}function c(t){t.preventDefault(),t.target!==this.selectedValue.target?this.setByOption(t.target):this.deselect(),this.hide()}function d(e){var i=t(e),o=i.text(),a=s(i.attr("data-value")),r=this.setData(e,o,a);this.options.removeClass("active"),i.addClass("active"),this.element.find(".dropdown-label-text").text(r.label),this.target.val(r.value),n("change",this)}function p(e){e=s(e);var i=this.options,n=i.filter(function(n){return e===t(i.get(n)).attr("data-value")});n&&this.setByOption(n.get(0))}function u(t,e,i){return this.selectedValue={target:t,label:e,value:s(i)},this.selectedValue}function v(t){t&&t.preventDefault(),this.active=!0,this.element.addClass("active"),n("show",this)}function f(t){t&&t.preventDefault(),this.active?this.hide():this.show()}function g(){return this.selectedValue.value}var y=t(document);e.Dropdown={_instances:[],all:function(){var t=this._instances;return t},create:function(t){var e=new m(t);this._instances.push(e)},get:function(t){var e=this._instances[t];return e},getById:function(t){for(var e=0;e<this._instances.length;e++)if(this._instances[e].target[0].id===t)return this._instances[e];return void 0}};var m=function(i){this.active=!1,this.element=t(i),this.options=this.element.find(".dropdown-option"),this.selectedValue="";var n=this.element.attr("data-target"),s=n.replace("#",""),o=t(n);if(!o.length)throw new w("A hidden input field is required to store the dropdown value");this.target=o;var a=e.getUrlParam(s);if(a)this.setByValue(a);else{var r=o.val();""!==r?this.setByValue(r):this.setByOption(this.options.get(0))}this.originalLabel=this.element.find(".dropdown-label-text").text(),this.options.click(this.select.bind(this)),this.element.find(".dropdown-label").click(this.toggle.bind(this))};m.prototype.addOption=i,m.prototype.deselect=a,m.prototype.get=r,m.prototype.getSelected=l,m.prototype.hide=h,m.prototype.select=c,m.prototype.setByOption=d,m.prototype.setByValue=p,m.prototype.setData=u,m.prototype.show=v,m.prototype.toggle=f,m.prototype.val=g;var w=function(t){this.name="Javelin.Dropdown Error",this.message=t,this.toString=function(){return this.name+": "+this.message}};y.ready(function(){t(".dropdown").each(function(t,i){e.Dropdown.create(i)}),t(document).click(o).bind("ontouchstart",o)})}(jQuery,Javelin);